<!DOCTYPE html>
<html>

<head>
  <title>Simulator</title>
</head>

<body>
  <div id="world">
    <!-- Object will be added here dynamically -->
  </div>

  <script src="http://localhost:4000/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    function createObj(id, pos, size) {
      const type = id.split('_')[0]

      const world = document.getElementById("world");

      const box = document.createElement("div");
      box.id = id
      box.style.width = size.width + "px";
      box.style.height = size.height + "px";
      box.style.left = (pos.x - size.width / 2) + "px";
      box.style.top = (pos.y - size.height / 2) + "px";
      box.style.position = 'absolute'
      box.style.backgroundColor = getColor(type)

      // const image = document.createElement("img");
      // image.src = imageSrc;
      // image.style.width = "100%";
      // image.style.height = "100%";
      // box.appendChild(image);

      world.appendChild(box);
    }

    function move(id, pos, size) {
      const obj = document.getElementById(id)
      obj.style.left = (pos.x - size.width / 2) + "px";
      obj.style.top = (pos.y - size.height / 2) + "px";
    }

    function getColor(type) {
      switch (type) {
        case 'Resource':
          return 'yellow'
        case 'Obstacle', 'Border':
          return 'grey'
        case 'Ant':
          return 'red'
        case 'Spider':
          return 'black'
      }
    }

    function clearWorld() {
      const divElement = document.getElementById('world'); // Replace 'your-div-id' with the actual ID of your div
      divElement.innerHTML = '';
    }

    socket.on('game start', entities => {
      entities.forEach(entity => {
        createObj(entity.id, entity.pos, entity.size)
      })
    })

    socket.on('ant update', ants => {
      console.log(ants)
      ants.forEach(entity => {
        move(entity.id, entity.pos, entity.size)
      })
    })

    socket.on('game end', score => {
      console.log(score)
      clearWorld()
    })
  </script>
</body>

</html>